# 原型模式

**原型模式 Prototype Pattern**：使用原型实例指定待创建对象的类型，并且通过复制这个原型来创建新的对象

是一种“另类”的创建型模式，创建新对象的工厂就是原型类自身。注意，克隆的对象具有新的内存地址。

# 结构

- Prototype 抽象原型类：声明克隆方法的接口，具体原型类的公共父类，可以是抽象类、接口和具体类
- ConcretePrototype 具体原型类：实现抽象原型类中声明的克隆方法，返回一个自己的克隆对象
- Client 客户类：通过直接实例化或工厂方法等方式获得一个原型对象，再通过克隆方法可获得多个同样的对象

# 原型管理器

将多个原型对象存储在一个集合中，供客户端使用。是一个专门负责克隆对象的工厂。
其中定义了一个集合用于存储原型对象，如果需要某个原型对象的一个克隆，可以通过复制集合中的对象来获得。

原型管理器的示例位于本目录的 `prototypemanager` 包下。

# 优缺点/适用环境

## 优点

- 当创建新的对象实例较复杂时，可以简化对象的创建过程，提高创建效率
- 扩展性较好，由于原型模式中提供了抽象原型类，在客户端可以针对抽象层编程，具体类写在配置文件中
- 提供了简化的创建结构，不需要有一个与产品等级结构相同的工厂等级结构，无须专门的工厂类创建产品
- 可以通过深克隆的方式保存对象状态，可辅助实现撤销操作。

## 缺点

- 需要为每一个类配置一个克隆方法，对已有类改造时需要修改源代码，违反开闭原则
- 实现深克隆时需要编写较为复杂的代码

## 适用环境

- 创建新对象成本较大，新对象可以通过复制已有对象来获得，如果是相似对象，则可以对其成员变量稍作修改
- 系统要保存对象的状态，而对象的状态变化很小
- 需要避免使用分层次的工厂类来创建分层次的对象，并且类的实例对象只有一个或很少的几个组合状态，
  通过复制原型对象获得新实例可能比使用构造函数创建一个新实例更方便

# 本例

使用某 OA（office automation）系统时，发现有些工作大同小异，在填写工作周报时很多内容是重复的，
因此希望有一种机制能快速创建相同或相似的周报，包括创建周报的附件。
试使用原型模式对该周报创作模块进行改进。

## 分析

- Object 基类自带了 clone 方法，可以实现浅拷贝，前提是子类实现了 Cloneable 接口
- 在以上情况下，Object 类相当于抽象原型类。创建 WeeklyLog 类实现 Cloneable 接口，作为具体原型类
- 在 WeeklyLog 中重写 clone 方法，调用父类方法，实现克隆
